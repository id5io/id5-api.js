/**
 * id5-api.js - The ID5 API is designed to make accessing the ID5 Universal ID simple for publishers and their ad tech vendors. The ID5 Universal ID is a shared, neutral identifier that publishers and ad tech platforms can use to recognise users even in environments where 3rd party cookies are not available. For more information, visit https://id5.io/universal-id.
 * @version v1.0.0-pre
 * @link https://id5.io/
 * @license Apache-2.0
 */
!function(t){var o={};function r(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=o,r.d=function(e,n,t){r.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:t})},r.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(n,"a",n),n},r.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},r.p="",r(r.s=2)}([function(e,n,t){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}t.d(n,"a",function(){return c});var r=t(1);var i,a,c=(a={debug:"Boolean",allowID5WithoutConsentApi:"Boolean",cmpApi:"String",consentData:"Object",cookieName:"String",refreshInSeconds:"Number",cookieExpirationInSeconds:"Number",partnerId:"Number",partnerUserId:"String",callback:"Function",callbackTimeoutInMs:"Number",pd:"String"},s(),{getConfig:function(){return i},setConfig:function(n){if("object"===o(n))return Object.keys(n).forEach(function(e){r.isA(n[e],a[e])?i[e]=n[e]:r.logError("setConfig options ".concat(e," must be of type ").concat(a[e]," but was ").concat(toString.call(n[e])))}),i;r.logError("setConfig options must be an object")},resetConfig:s});function s(){i={debug:"TRUE"===r.getParameterByName("id5_debug").toUpperCase(),allowID5WithoutConsentApi:!1,cmpApi:"iab",consentData:{getConsentData:{consentData:void 0,gdprApplies:void 0},getVendorConsents:{}},cookieName:"id5id.1st",refreshInSeconds:7200,cookieExpirationInSeconds:7776e3,partnerId:void 0,partnerUserId:void 0,callback:void 0,callbackTimeoutInMs:void 0,pd:""}}},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),t.d(n,"bind",function(){return I}),n.replaceTokenInString=function(r,e,i){return T(e,function(e,n){e=void 0===e?"":e;var t=i+n.toUpperCase()+i,o=new RegExp(t,"g");r=r.replace(o,e)}),r},n.logMessage=k,n.logInfo=function(){S()&&v&&console.info.apply(console,w(arguments,"INFO:"))},n.logWarn=function(){S()&&b&&console.warn.apply(console,w(arguments,"WARNING:"))},n.logError=D,n.debugTurnedOn=S,n.getParameterByName=function(e){var n=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(window.location.search);return null!==n?decodeURIComponent(n[1].replace(/\+/g," ")):""},n.isA=A,n.isFn=O,n.isStr=E,n.isArray=_,n.isNumber=function(e){return A(e,p)},n.isPlainObject=function(e){return A(e,f)},n.isBoolean=function(e){return A(e,d)},n.isEmpty=x,n._each=T,n._map=function(t,o){if(x(t))return[];if(O(t.map))return t.map(o);var r=[];return T(t,function(e,n){r.push(o(e,n,t))}),r},n.isSafariBrowser=function(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)},n.checkCookieSupport=function(){if(window.navigator.cookieEnabled||document.cookie.length)return!0},n.cookiesAreEnabled=function(){return window.document.cookie="id5.cookieTest",-1!==window.document.cookie.indexOf("id5.cookieTest")},n.getCookie=function(e){var n=window.document.cookie.match("(^|;)\\s*"+e+"\\s*=\\s*([^;]*)\\s*(;|$)");return n?decodeURIComponent(n[2]):null},n.setCookie=function(e,n,t){document.cookie="".concat(e,"=").concat(encodeURIComponent(n)).concat(""!==t?"; expires=".concat(t):"","; path=/")},n.parseQS=j,n.formatQS=P,n.parse=U,n.format=N,n.ajax=function(e,n,t){var o,r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};try{var i=r.method||(t?"POST":"GET");document.createElement("a").href=e;var a,c="object"===u(n)&&null!==n?n:{success:function(){k("xhr success")},error:function(e){D("xhr error",null,e)}};"function"==typeof n&&(c.success=n),(o=new window.XMLHttpRequest).onreadystatechange=function(){var e;o.readyState===R&&(200<=(e=o.status)&&e<300||304===e?c.success(o.responseText,o):c.error(o.statusText,o))},o.ontimeout=function(){D("  xhr timeout after ",o.timeout,"ms")},"GET"===i&&t&&(s((a=U(e,r)).search,t),e=N(a)),o.open(i,e,!0),r.withCredentials&&(o.withCredentials=!0),T(r.customHeaders,function(e,n){o.setRequestHeader(n,e)}),r.preflight&&o.setRequestHeader("X-Requested-With","XMLHttpRequest"),o.setRequestHeader("Content-Type",r.contentType||"text/plain"),"POST"===i&&t?o.send(t):o.send()}catch(e){D("xhr construction",e)}},n.fireAsyncPixel=M,n.deferPixelFire=function(e,n){"loading"!==document.readyState?M(e,n):document.addEventListener("DOMContentLoaded",function(){M(e,n)})},n.cyrb53Hash=function(e){for(var n,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,o=function(e,n){if(O(Math.imul))return Math.imul(e,n);var t=(4194303&e)*(n|=0);return 4290772992&e&&(t+=(4290772992&e)*n|0),0|t},r=3735928559^t,i=1103547991^t,a=0;a<e.length;a++)n=e.charCodeAt(a),r=o(r^n,2654435761),i=o(i^n,1597334677);return r=o(r^r>>>16,2246822507)^o(i^i>>>13,3266489909),(4294967296*(2097151&(i=o(i^i>>>16,2246822507)^o(r^r>>>13,3266489909)))+(r>>>0)).toString()};var o=t(0);function s(){return(s=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e}).apply(this,arguments)}function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var t=[],o=!0,r=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(o=(a=c.next()).done)&&(t.push(a.value),!n||t.length!==n);o=!0);}catch(e){r=!0,i=e}finally{try{o||null==c.return||c.return()}finally{if(r)throw i}}return t}(e,n)||function(e,n){if(!e)return;if("string"==typeof e)return r(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return r(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,o=new Array(n);t<n;t++)o[t]=e[t];return o}var a="Array",c="String",l="Function",p="Number",f="Object",d="Boolean",g=Object.prototype.toString,h=Boolean(window.console),m=Boolean(h&&window.console.log),v=Boolean(h&&window.console.info),b=Boolean(h&&window.console.warn),y=Boolean(h&&window.console.error),C={},I=function(e,n){return n}.bind(null,1,C)()===C?Function.prototype.bind:function(e){var n=this,t=Array.prototype.slice.call(arguments,1);return function(){return n.apply(e,t.concat(Array.prototype.slice.call(arguments)))}};function k(){S()&&m&&console.log.apply(console,w(arguments,"MESSAGE:"))}function D(){S()&&y&&console.error.apply(console,w(arguments,"ERROR:"))}function w(e,n){return e=[].slice.call(e),n&&e.unshift(n),e.unshift("display: inline-block; color: #fff; background: #1c307e; padding: 1px 4px; border-radius: 3px;"),e.unshift("%cID5"),e}function S(){return o.a.getConfig().debug}function A(e,n){return g.call(e)==="[object "+n+"]"}function O(e){return A(e,l)}function E(e){return A(e,c)}function _(e){return A(e,a)}function x(e){if(!e)return!0;if(_(e)||E(e))return!(0<e.length);for(var n in e)if(hasOwnProperty.call(e,n))return!1;return!0}function T(e,n){if(!x(e)){if(O(e.forEach))return e.forEach(n,this);var t=0,o=e.length;if(0<o)for(;t<o;t++)n(e[t],t,e);else for(t in e)hasOwnProperty.call(e,t)&&n.call(this,e[t],t)}}function j(e){return e?e.replace(/^\?/,"").split("&").reduce(function(e,n){var t=i(n.split("="),2),o=t[0],r=t[1];return/\[\]$/.test(o)?(e[o=o.replace("[]","")]=e[o]||[],e[o].push(r)):e[o]=r||"",e},{}):{}}function P(e){return Object.keys(e).map(function(n){return Array.isArray(e[n])?e[n].map(function(e){return"".concat(n,"[]=").concat(e)}).join("&"):"".concat(n,"=").concat(e[n])}).join("&")}function U(e,n){var t=document.createElement("a");n&&"noDecodeWholeURL"in n&&n.noDecodeWholeURL?t.href=e:t.href=decodeURIComponent(e);var o=n&&"decodeSearchAsString"in n&&n.decodeSearchAsString;return{href:t.href,protocol:(t.protocol||"").replace(/:$/,""),hostname:t.hostname,port:+t.port,pathname:t.pathname.replace(/^(?!\/)/,"/"),search:o?t.search:j(t.search||""),hash:(t.hash||"").replace(/^#/,""),host:t.host||window.location.host}}function N(e){return(e.protocol||"http")+"://"+(e.host||e.hostname+(e.port?":".concat(e.port):""))+(e.pathname||"")+(e.search?"?".concat(P(e.search||"")):"")+(e.hash?"#".concat(e.hash):"")}var R=4;function M(e,n){(new Image).src=e,O(n)&&n()}},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),t.d(n,"ID5",function(){return S});var o=t(3),y=t(0),C=t(1),I=t(4),k=t(5),D={name:"id5id.cached_consent_data",expires:30},w={name:"id5id.cached_pd",expires:30},S=Object(o.a)();function A(e){return"".concat(e.cookieName,"_last")}function O(e){return"".concat(e.cookieName,"_").concat(e.partnerId,"_nb")}function E(e){var n={consentString:"",gdprApplies:!1,apiVersion:0};return e&&(n.consentString=e.consentString,n.gdprApplies=e.gdprApplies,n.apiVersion=e.apiVersion),C.cyrb53Hash(JSON.stringify(n))}function _(e){return C.cyrb53Hash("string"==typeof e?e:"")}function r(e,n){try{var t=new Date(Date.now()+864e5*e.expires).toUTCString();C.setCookie(e.name,n,t,"Lax")}catch(e){C.logError(e)}}function x(e,n){return null==e||e===n}function T(e){try{return C.getCookie(e)}catch(e){C.logError(e)}}S.loaded=!0,S.initialized=!1,S.callbackFired=!1,S.init=function(e){var n,t,o,r,i,s=this;if(void 0===S.version)throw new Error('ID5.version variable is missing! Make sure you build from source with "gulp build" from this project. Contact support@id5.io for help.');try{C.logInfo("Invoking ID5.init",arguments);var u=y.a.setConfig(e);S.userConfig=e,S.config=u,S.initialized=!0,S.callbackFired=!1,S.getConfig=y.a.getConfig;var l=Object(k.a)();if(C.logInfo("ID5 detected referer is ".concat(l.referer)),"number"!=typeof u.partnerId)throw new Error("partnerId is required and must be a number");var p=JSON.parse(C.getCookie(u.cookieName)),a=new Date(+C.getCookie(A(u))).getTime(),f=a<=0||Date.now()-a>1e3*u.refreshInSeconds,d=new Date(Date.now()+1e3*u.cookieExpirationInSeconds).toUTCString(),g=(r=u,(i=C.getCookie(O(r)))?parseInt(i):0),h=!1,m=u.pd||"",c=T(w.name);this.setStoredPd(m);var v,b=!x(c,_(m));C.isFn(this.config.callback)&&0<=this.config.callbackTimeoutInMs&&setTimeout(function(){return s.fireCallBack()},this.config.callbackTimeoutInMs),"id5.1st"!==u.cookieName&&(v=new Date(Date.now()-1e3).toUTCString(),C.setCookie("id5.1st","",v),C.setCookie("id5.1st_last","",v),C.setCookie("id5.1st_nb","",v)),p&&!b?(p.ID5ID?S.userId=p.ID5ID:p.universal_uid&&(S.userId=p.universal_uid,S.linkType=p.link_type||0),n=u,t=d,o=g,o++,C.setCookie(O(n),o,t),g=o,h=!0,S.userId&&this.fireCallBack(),C.logInfo("ID5 User ID available from cache:",{storedResponse:p,storedDateTime:a,refreshNeeded:f})):p&&b?C.logInfo("PD value has changed, so ignoring User ID from cache"):C.logInfo("No ID5 User ID available from cache"),I.b(function(e){var r,i,n,t,o,a,c=T(D.name);s.setStoredConsentData(e),I.a()?(C.logInfo("Consent to access local storage and cookies is given"),p&&p.universal_uid&&p.signature&&!f&&x(c,E(e))&&!b||(r=e&&e.gdprApplies?1:0,i=e&&e.gdprApplies?e.consentString:"",n="https://id5-sync.com/g/v2/".concat(u.partnerId,".json?gdpr_consent=").concat(i,"&gdpr=").concat(r),t=p&&p.signature?p.signature:"",o=p&&p.ID5ID?p.ID5ID:"",a={partner:u.partnerId,"1puid":o,v:S.version,o:"api",rf:l.referer,u:l.stack[0]||window.location.href,top:l.reachedTop?1:0,s:t,pd:m,nbPage:g},C.logInfo("Fetching ID5 user ID from:",n,a),C.ajax(n,{success:function(e){var n,t,o;if(C.logInfo("Response from ID5 received:",e),e)try{(o=JSON.parse(e)).universal_uid?(S.userId=o.universal_uid,C.setCookie(u.cookieName,e,d),C.setCookie(A(u),Date.now(),d),C.setCookie(O(u),h?0:1,d),!0===o.cascade_needed&&(n=u.partnerUserId&&0<u.partnerUserId.length,t="https://id5-sync.com/".concat(n?"s":"i","/").concat(u.partnerId,"/8.gif?").concat(n?"puid="+u.partnerUserId+"&":"","gdpr_consent=").concat(i,"&gdpr=").concat(r),C.logInfo("Opportunities to cascade available:",t),C.deferPixelFire(t)),s.fireCallBack()):C.logError("Invalid response from ID5 servers:",e)}catch(e){C.logError(e)}},error:function(e){C.logError(e)}},JSON.stringify(a),{method:"POST",withCredentials:!0}))):C.logInfo("No legal basis to use ID5",e)})}catch(e){C.logError("Exception catch",e)}},S.fireCallBack=function(){var e=this;!this.callbackFired&&C.isFn(this.config.callback)&&(this.callbackFired=!0,C.logInfo("Scheduling callback"),setTimeout(function(){return e.config.callback(S)},0))},S.setStoredConsentData=function(e){r(D,E(e))},S.setStoredPd=function(e){r(w,_(e))},n.default=S},function(e,n,t){"use strict";n.a=function(){return window.ID5},window.ID5=window.ID5||{}},function(e,n,t){"use strict";n.b=function(e){var n=i.a.getConfig();n.allowID5WithoutConsentApi?(a.logError("ID5 is operating in forced consent mode"),e(r)):s[n.cmpApi]?r?e(r):("static"===n.cmpApi&&(a.isPlainObject(i.a.getConfig().consentData)?o=i.a.getConfig().consentData:a.logError("cmpApi: 'static' did not specify consentData.")),s[n.cmpApi].call(this,u,e)):(a.logError("Unknown consent API: ".concat(n.cmpApi)),l(),e(r))},n.a=function(){return!!i.a.getConfig().allowID5WithoutConsentApi||!!r&&("boolean"!=typeof r.gdprApplies||!r.gdprApplies||!(!r.consentString||0===r.apiVersion)&&((1!==r.apiVersion||!r.vendorData||!r.vendorData.purposeConsents||!1!==r.vendorData.purposeConsents[1])&&!(2===r.apiVersion&&r.vendorData&&r.vendorData.purpose&&r.vendorData.purpose.consents&&!1===r.vendorData.purpose.consents[1])))};var r,o,a=t(1),i=t(0),c=0,s={iab:function(o,r){var e=function(){var n={};function t(){n.getConsentData&&n.getVendorConsents&&o(n,r)}return{consentDataCallback:function(e){a.logInfo("cmpApi: consentDataCallback"),n.getConsentData=e,t()},vendorConsentsCallback:function(e){a.logInfo("cmpApi: vendorConsentsCallback"),n.getVendorConsents=e,t()}}}(),n=function(){c=0;for(var e,n,t=window;!e;){try{if("function"==typeof t.__tcfapi||"function"==typeof t.__cmp){n="function"==typeof t.__tcfapi?(c=2,t.__tcfapi):(c=1,t.__cmp),e=t;break}}catch(e){}try{if(t.frames.__tcfapiLocator){c=2,e=t;break}}catch(e){}try{if(t.frames.__cmpLocator){c=1,e=t;break}}catch(e){}if(t===window.top)break;t=t.parent}return{cmpFrame:e,cmpFunction:n}}(),t=n.cmpFrame,i=n.cmpFunction;if(!t)return a.logError("CMP not found"),o(void 0,r);a.isFn(i)?(a.logInfo("cmpApi: calling getConsentData & getVendorConsents"),1===c?(i("getConsentData",null,e.consentDataCallback),i("getVendorConsents",null,e.vendorConsentsCallback)):2===c&&i("addEventListener",c,function(e,n){a.logInfo("Received a response from CMP",e),n?!1!==e.gdprApplies&&"tcloaded"!==e.eventStatus&&"useractioncomplete"!==e.eventStatus||o(e,r):(a.logError("CMP unable to register callback function.  Please check CMP setup."),o(void 0,r))})):o(void 0,r)},static:function(e,n){e(o,n)}};function u(t,e){"static"===i.a.getConfig().cmpApi&&2===(c=t.getConsentData?1:t.getTCData?2:0)&&(t=t.getTCData);var n,o=1===c?function(e){var n=e&&e.getConsentData&&e.getConsentData.gdprApplies;return!("boolean"==typeof n&&(!0!==n||a.isStr(e.getConsentData.consentData)&&a.isPlainObject(e.getVendorConsents)&&1<Object.keys(e.getVendorConsents).length))}:2===c?function(){var e=t&&"boolean"==typeof t.gdprApplies?t.gdprApplies:void 0,n=t&&t.tcString;return!("boolean"==typeof e&&(!0!==e||a.isStr(n)))}:null;a.logInfo("CMP Success callback for version",c,o),a.isFn(o)&&(o(t)?(l(),a.logError("CMP returned unexpected value during lookup process.",t)):(n=t,r=1===c?{consentString:n?n.getConsentData.consentData:void 0,vendorData:n?n.getVendorConsents:void 0,gdprApplies:n?n.getConsentData.gdprApplies:void 0,apiVersion:1}:2===c?{consentString:n?n.tcString:void 0,vendorData:n||void 0,gdprApplies:n&&"boolean"==typeof n.gdprApplies?n.gdprApplies:void 0,apiVersion:2}:{apiVersion:0})),e(r)}function l(){r=void 0}},function(e,n,t){"use strict";function r(){return(r=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e}).apply(this,arguments)}t.d(n,"a",function(){return o});var i,o=(i=window,function(){try{var e,n=a(),t=n.length-1,o=null!==n[t].location||0<t&&null!==n[t-1].referrer,r=function(e){for(var n,t=[],o=null,r=null,i=null,a=null,c=null,s=e.length-1;0<=s;s--){try{r=e[s].location}catch(e){}if(r)t.push(r),c=c||r;else if(0!==s){n=e[s-1];try{i=n.referrer,a=n.ancestor}catch(e){}i?(t.push(i),c=c||i):a?(t.push(a),c=c||a):t.push(o)}else t.push(o)}return{stack:t,detectedRefererUrl:c}}(n);return n[n.length-1].canonicalUrl&&(e=n[n.length-1].canonicalUrl),{referer:r.detectedRefererUrl,reachedTop:o,numIframes:t,stack:r.stack,canonicalUrl:e}}catch(e){}});function a(){var e=function(){var n,t=[];do{try{n=n?n.parent:i;try{var e=n===i.top,o={referrer:n.document.referrer||null,location:n.location.href||null,isTop:e};e&&(o=r(o,{canonicalUrl:function(e){try{var n=e.querySelector("link[rel='canonical']");if(null!==n)return n.href}catch(e){}return null}(n.document)})),t.push(o)}catch(e){t.push({referrer:null,location:null,isTop:n===i.top})}}catch(e){return t.push({referrer:null,location:null,isTop:!1}),t}}while(n!==i.top);return t}(),n=function(){try{if(!i.location.ancestorOrigins)return;return i.location.ancestorOrigins}catch(e){}}();if(n)for(var t=0,o=n.length;t<o;t++)e[t].ancestor=n[t];return e}}]),ID5.version="1.0.0-pre";